{"./":{"url":"./","title":"å‰è¨€","keywords":"","body":".Net Core .NET Core æ˜¯å¼€æ”¾æºä»£ç é€šç”¨å¼€å‘å¹³å°ï¼Œç”± Microsoft å’Œ .NET ç¤¾åŒºåœ¨ GitHub ä¸Šå…±åŒç»´æŠ¤ã€‚ å®ƒè·¨å¹³å°ï¼ˆæ”¯æŒ Windowsã€macOS å’Œ Linuxï¼‰ï¼Œå¹¶ä¸”å¯ç”¨äºç”Ÿæˆè®¾å¤‡ã€äº‘å’Œ IoT åº”ç”¨ç¨‹åºã€‚ https://docs.microsoft.com/zh-cn/dotnet/core/about .NET Core å…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š è·¨å¹³å°ï¼š å¯ä»¥åœ¨ Windowsã€macOS å’Œ Linux æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œã€‚ è·¨ä½“ç³»ç»“æ„ä¿æŒä¸€è‡´ï¼š åœ¨å¤šä¸ªä½“ç³»ç»“æ„ï¼ˆåŒ…æ‹¬ x64ã€x86 å’Œ ARMï¼‰ä¸Šä»¥ç›¸åŒçš„è¡Œä¸ºè¿è¡Œä»£ç ã€‚ å‘½ä»¤è¡Œå·¥å…·ï¼š åŒ…æ‹¬ç”¨äºæœ¬åœ°å¼€å‘å’ŒæŒç»­é›†æˆæ–¹æ¡ˆä¸­çš„æ˜“äºä½¿ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ã€‚ éƒ¨ç½²çµæ´»ï¼š å¯ä»¥åŒ…å«åœ¨åº”ç”¨æˆ–å·²å®‰è£…çš„å¹¶è¡Œç”¨æˆ·æˆ–è®¡ç®—æœºèŒƒå›´ä¸­ã€‚ å¯æ­é… Docker å®¹å™¨ä½¿ç”¨ã€‚ å…¼å®¹æ€§ï¼š.NET Core é€šè¿‡ .NET Standardä¸ .NET Frameworkã€Xamarin å’Œ Mono å…¼å®¹ã€‚ å¼€æ”¾æºï¼š.NET Core æ˜¯ä¸€ä¸ªå¼€æ”¾æºå¹³å°ï¼Œä½¿ç”¨ MIT å’Œ Apache 2 è®¸å¯è¯ã€‚ .NET Core æ˜¯ä¸€ä¸ª .NET * oundation é¡¹ç›®ã€‚ ç”± Microsoft æ”¯æŒï¼š.NET Core ç”± Microsoft ä¾æ® .NET Core æ”¯æŒæä¾›æ”¯æŒã€‚ Â© Colin Chang all right reservedï¼Œpowered by Gitbookæ–‡ä»¶ä¿®è®¢æ—¶é—´ï¼š 2018-12-10 20:13:55 "},"pages/uninstall.html":{"url":"pages/uninstall.html","title":".Net Core å®‰è£…å¸è½½","keywords":"","body":".Net Core å®‰è£…å¸è½½ ä½œä¸ºæ–°ä¸€ä»£å¾®è½¯é«˜æ•ˆè·¨å¹³å°æŠ€æœ¯ï¼Œ.Net Coreè‡ªè¯ç”Ÿä»¥æ¥å°±æ˜¯è·¨å¹³å°çš„ï¼Œç›®å‰æ”¯æŒWindows/mac OS/Linuxå¹³å°ã€‚ Linuxå‘è¡Œç‰ˆä¼—å¤šï¼Œæˆªæ­¢åˆ°å†™è¿™ç¯‡æ–‡æ¡£æ—¶ï¼Œ.Net Core 2.2æ”¯æŒçš„Linuxå‘è¡Œç‰ˆå¦‚ä¸‹ï¼š RHEL Ubuntu 18.04 Ubuntu 16.04 Ubuntu 14.04 Debian 9 Debian 8 Fedora 28 Fedora 27 CentOS / Oracle openSUSE Leap SLES 1. å®‰è£… .Net Coreçš„å®‰è£…å¼‚å¸¸ç®€å•ã€‚åˆ°å®˜ç½‘ä¸‹è½½å®‰è£…å³å¯ã€‚Windowså’ŒMacä¸­éƒ½æ˜¯ä¸‹è½½å®‰è£…åŒ…ï¼ŒåŒå‡»è¿è¡Œå®‰è£…ï¼Œä¸å†èµ˜è¿°ã€‚Linuxé€‰æ‹©å¯¹åº”çš„å‘è¡Œç‰ˆæœ¬ï¼Œæ‰§è¡Œå®˜æ–¹çš„å®‰è£…å‘½ä»¤å³å¯ã€‚ æé†’ Debian 9 å®‰è£….Net Coreä¹‹å‰è¦å…ˆå®‰è£…apt-transport-httpsï¼ˆå®˜æ–¹å®‰è£…æ­¥éª¤é—æ¼äº†æ­¤æ­¥éª¤ï¼‰ $ sudo apt-get install apt-transport-https å¦‚æœæƒ³ä½“éªŒæœ€æ–°ç‰ˆçš„.Net Coreçš„ç‰¹æ€§ï¼Œåˆ™å¯ä»¥åˆ°.Net Coreçš„Githubé¡¹ç›®ä¸­ä¸‹è½½ã€‚è¿™é‡Œæœ‰.Net Coreæ‰€æœ‰ç‰ˆæœ¬ï¼ŒåŒ…æ‹¬å†å²ç‰ˆæœ¬å’Œé¢„è§ˆç‰ˆæœ¬ã€‚ https://github.com/dotnet/core/tree/master/release-notes .Net Coreå®‰è£…åŒ…åˆ†ä¸ºRuntimeå’ŒSDKã€‚å¦‚æœåªæœŸæœ›åœ¨å¹³å°ä¸Šè¿è¡Œ.Net Coreç¨‹åºï¼Œå®‰è£…RuntimeåŒ…å³å¯ã€‚å¦‚æœå¸Œæœ›åœ¨å¹³å°ä¸Šä½¿ç”¨.Net Coreçš„é«˜çº§åŠŸèƒ½ï¼Œå¦‚å¼€å‘è°ƒè¯•ç­‰ï¼Œåˆ™éœ€è¦å®‰è£…SDKåŒ…ã€‚SDKåŒ…å«äº†Runtimeã€‚ 2. å¸è½½ .Net Coreåœ¨Windowså¸è½½éå¸¸ç®€å•ï¼Œç›´æ¥åœ¨æ§åˆ¶é¢æ¿ä¸­å¸è½½å³å¯ã€‚è‡³äºMacå’ŒLinuxç¯å¢ƒä¸‹å¸è½½å°±æ¯”è¾ƒéº»çƒ¦äº†ã€‚ç”±äºå®‰è£…æ–‡ä»¶æ¯”è¾ƒåˆ†æ•£ï¼Œæ‰€ä»¥åˆ é™¤å’Œæ¸…ç†å·¥ä½œä¹Ÿæ¯”è¾ƒç¹çï¼Œå¹¸å¥½.NET Foundationæä¾›äº†å¸è½½è„šæœ¬ã€‚ #!/usr/bin/env bash # # Copyright (c) .NET Foundation and contributors. All rights reserved. # Licensed under the MIT license. See LICENSE file in the project root for full license information. # DIR=\"$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\" current_userid=$(id -u) if [ $current_userid -ne 0 ]; then echo \"$(basename \"$0\") uninstallation script requires superuser privileges to run\" >&2 exit 1 fi # this is the common suffix for all the dotnet pkgs dotnet_pkg_name_suffix=\"com.microsoft.dotnet\" dotnet_install_root=\"/usr/local/share/dotnet\" dotnet_path_file=\"/etc/paths.d/dotnet\" remove_dotnet_pkgs(){ installed_pkgs=($(pkgutil --pkgs | grep $dotnet_pkg_name_suffix)) for i in \"${installed_pkgs[@]}\" do echo \"Removing dotnet component - \\\"$i\\\"\" >&2 pkgutil --force --forget \"$i\" done } remove_dotnet_pkgs [ \"$?\" -ne 0 ] && echo \"Failed to remove dotnet packages.\" >&2 && exit 1 echo \"Deleting install root - $dotnet_install_root\" >&2 rm -rf \"$dotnet_install_root\" rm -f \"$dotnet_path_file\" echo \"dotnet packages removal succeeded.\" >&2 exit 0 ä½¿ç”¨ä»¥ä¸Šè„šæœ¬å¸è½½å³å¯ã€‚ å¦‚æœå¯¹shellè„šæœ¬ä¸ç†Ÿæ‚‰çš„å°ä¼™ä¼´ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¿«é€Ÿå¸è½½ï¼Œä»¥macä¸ºä¾‹ï¼Œ $ curl -o uninstall.sh https://gist.githubusercontent.com/colin-chang/1d8da588f399165924dc62dad42598d8/raw/50444ab4db30ab8d6205216dec0c3983333a5d6b/dotnet-uninstall-pkgs.sh $ chmod -R 740 uninstall.sh $ sudo sh uninstall.sh $ rm uninstall.sh Â© Colin Chang all right reservedï¼Œpowered by Gitbookæ–‡ä»¶ä¿®è®¢æ—¶é—´ï¼š 2018-12-11 18:34:57 "},"pages/deploy.html":{"url":"pages/deploy.html","title":".Net Core éƒ¨ç½²","keywords":"","body":".Net Core éƒ¨ç½² .Net Coreç¨‹åºå¯ä»¥éƒ¨ç½²åœ¨Windows/Linux/macå¹³å°ä¸Šã€‚Macè¾ƒå¤šçš„ç”¨äºå¼€å‘ï¼Œé²œå°‘ç”¨åšæœåŠ¡å™¨ç¯å¢ƒã€‚ä¸‹é¢æˆ‘ä»¬ä»¥Asp.Net Coreä¸ºä¾‹ï¼Œç®€å•æ¢³ç†ä¸€ä¸‹ã€‚ .net coreç¨‹åºæ— è®ºæ˜¯è°ƒè¯•è¿˜æ˜¯å‘å¸ƒç‰ˆæœ¬ï¼Œéƒ½å»ºè®®åœ¨ç¨‹åºç›®å½•ä¸‹è¿è¡Œå‘½ä»¤ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°é™æ€èµ„æºæ–‡ä»¶æ— æ³•è®¿é—®çš„é—®é¢˜ã€‚ å‘å¸ƒå‘½ä»¤ dotnet publish -c Release 1. Linux åœ¨Linuxä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ dotnet ./your_app.dll æ–¹å¼åœ¨ç»ˆç«¯ä¸­è¿è¡Œ.Net Coreç¨‹åºï¼Œä½†æ˜¯é€€å‡ºç»ˆç«¯åï¼Œç¨‹åºå°±åœæ­¢äº†ã€‚æˆ‘ä»¬å¯ä»¥å°†è¿è¡Œå‘½ä»¤å°è£…åˆ°ä¸€ä¸ªLinuxæœåŠ¡ä¸­ï¼ŒæœåŠ¡å™¨å¯åŠ¨åå°±å¯ä»¥åœ¨åå°é™é»˜è¿è¡Œäº†ã€‚ systemd å¯ç”¨äºåˆ›å»ºæœåŠ¡æ–‡ä»¶ä»¥å¯åŠ¨å’Œç›‘è§†åŸºç¡€ Web åº”ç”¨ã€‚ systemd æ˜¯ä¸€ä¸ª init ç³»ç»Ÿï¼Œå¯ä»¥æä¾›ç”¨äºå¯åŠ¨ã€åœæ­¢å’Œç®¡ç†è¿›ç¨‹çš„è®¸å¤šå¼ºå¤§çš„åŠŸèƒ½ã€‚ åˆ›å»ºæœåŠ¡æ–‡ä»¶ $ sudo vi /etc/systemd/system/lottery.service æœåŠ¡æ–‡ä»¶ç¤ºä¾‹ [Unit] # æœåŠ¡æè¿° Description=Lottery [Service] # å·¥ä½œç›®å½•ï¼Œæ­¤å¤„ä¸º.net coreç¨‹åºç›®å½• WorkingDirectory=/home/colin/apps/content/lottery # dotnetæ ¸å¿ƒå‘½ä»¤ ExecStart=/usr/bin/dotnet /home/colin/apps/content/lottery/Lottery.WebApp.dll # é‡å¯ç­–ç•¥ Restart=always RestartSec=10 # æ—¥å¿—æ ‡è¯† SyslogIdentifier=dotnet-lottery # ç”¨æˆ· User=colin # ç¯å¢ƒå˜é‡ Environment=ASPNETCORE_ENVIRONMENT=Production Environment=DOTNET_PRINT_TELEMETRY_MESSAGE=false [Install] WantedBy=multi-user.target æœåŠ¡ç®¡ç† # å¯ç”¨æœåŠ¡ $ sudo systemctl enable lottery.service # å¯åŠ¨æœåŠ¡ $ sudo systemctl start lottery.service # æŸ¥çœ‹æœåŠ¡çŠ¶æ€ $ sudo systemctl status lottery.service # åœæ­¢æœåŠ¡ $ sudo systemctl stop lottery.service # é‡å¯æœåŠ¡ $ sudo systemctl restart lottery.service å®Œæˆä»¥ä¸Šæ­¥éª¤ä¹‹åï¼ŒAsp.Net Coreç¨‹åºå·²ç»æŒ‚è½½åˆ°äº†KestrelæœåŠ¡å™¨ä¸Šå¹¶ä»¥LinuxæœåŠ¡æ–¹å¼åå°é™é»˜è¿è¡Œã€‚è™½ç„¶KestrelæœåŠ¡å™¨å¯¹Asp.Netæ”¯æŒéå¸¸å¥½ï¼Œä½†å¾®è½¯ä¸å»ºè®®å…¶ä½œä¸ºå¯¹å¤–æœåŠ¡å™¨ï¼Œè€Œæ˜¯å»ºè®®ä½¿ç”¨IIS/Nginx/Apacheç­‰ä½œä¸ºä»£ç†æœåŠ¡å™¨å¯¹å¤–å¼€æ”¾ã€‚ å…³äºLinuxä¸‹Nginxéƒ¨ç½²ï¼Œå‚é˜…ï¼š http://colin-chang.site/book/linux/part2/nginx.html https://docs.microsoft.com/zh-cn/aspnet/core/host-and-deploy/linux-nginx?view=aspnetcore-2.2 Apacheé…ç½®ï¼Œå‚é˜…ï¼š https://docs.microsoft.com/zh-cn/aspnet/core/host-and-deploy/linux-apache?view=aspnetcore-2.2 2. Windows Windows ä¸‹.Net Coreéƒ¨ç½²å‚é˜…ï¼š https://docs.microsoft.com/zh-cn/aspnet/core/host-and-deploy/iis/?view=aspnetcore-2.2 Â© Colin Chang all right reservedï¼Œpowered by Gitbookæ–‡ä»¶ä¿®è®¢æ—¶é—´ï¼š 2018-12-10 20:18:12 "},"pages/dapper.html":{"url":"pages/dapper.html","title":"Dapper","keywords":"","body":"Dapper å…¨æ”»ç•¥ 1. ç®€ä»‹ 2. é¡¹ç›®/æ¨¡å‹ 3. CRUD 4. å…¶ä»– 5. Dapper Plus 1. ç®€ä»‹ Dapperæ˜¯.NETä¸‹ä¸€ä¸ªè½»é‡çº§çš„ORMæ¡†æ¶ï¼Œå®ƒå’ŒEntity Frameworkæˆ–Nhibnateä¸åŒï¼Œå±äºè½»é‡çº§çš„ï¼Œå¹¶ä¸”æ˜¯åŠè‡ªåŠ¨çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å®ä½“ç±»éƒ½è¦è‡ªå·±å†™ã€‚å®ƒæ²¡æœ‰å¤æ‚çš„é…ç½®æ–‡ä»¶ï¼Œä¸€ä¸ªå•æ–‡ä»¶å°±å¯ä»¥äº†ã€‚Dapperé€šè¿‡æä¾›IDbConnectionæ‰©å±•æ–¹æ³•æ¥è¿›è¡Œå·¥ä½œã€‚ Dapperæ²¡æœ‰å®šä¹‰ç‰¹å®šçš„æ•°æ®åº“è¦æ±‚ï¼Œå®ƒæ”¯æŒæ‰€æœ‰ADO.NETæ”¯æŒçš„æ•°æ®åº“ï¼Œå¦‚SQLite,SQL CE,Firebird,Oracle,MySQL,PostgreSQL,SQL Serverç­‰ã€‚ å›½å¤–çŸ¥åç½‘ç«™Stack Overflowç”Ÿäº§ç¯å¢ƒä½¿ç”¨Dapperè¿›è¡Œæ•°æ®åº“è®¿é—®ã€‚ 2. é¡¹ç›®/æ¨¡å‹ ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„.Net Coreæ§åˆ¶å°é¡¹ç›®æ¥å¿«é€Ÿå…¥é—¨Dappperä½¿ç”¨ã€‚æ•°æ®åº“ä½¿ç”¨MySQLã€‚ 2.1 åˆ›å»ºé¡¹ç›® # åˆ›å»º.net coreæ§åˆ¶å°é¡¹ç›® $ dotnet new console -n DapperDemo # å¼•ç”¨Dapperå’ŒMySQL nugetåŒ… $ dotnet add package Dapper $ dotnet add package MySql.Data 2.2 æ•°æ®æ¨¡å‹ 1) æ•°æ®åº“ CREATE TABLE `article` ( `Id` int(11) NOT NULL AUTO_INCREMENT, `Title` varchar(255) NOT NULL, `Content` text NOT NULL, `Status` int(1) NOT NULL DEFAULT '1', `UpdateTime` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP, `AuthorId` int(11) NOT NULL, PRIMARY KEY (`Id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; CREATE TABLE `author` ( `Id` int(11) NOT NULL AUTO_INCREMENT, `NickName` varchar(255) NOT NULL, `RealName` varchar(255) NOT NULL, `BirthDate` date DEFAULT NULL, `Address` varchar(255) DEFAULT NULL, PRIMARY KEY (`Id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; CREATE TABLE `comment` ( `Id` int(11) NOT NULL AUTO_INCREMENT, `ArticleId` int(11) NOT NULL, `Content` varchar(255) NOT NULL, `CreateTime` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (`Id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; 2) æ•°æ®æ¨¡å‹ public abstract class BaseModel { public int Id { get; set; } } public class Author : BaseModel { public string NickName { get; set; } public string RealName { get; set; } public DateTime? BirthDate { get; set; } public string Address { get; set; } public Author() { } public Author(string nickName, string realName) { NickName = nickName; RealName = realName; } } public class Article : BaseModel { public string Title { get; set; } public string Content { get; set; } public ArticleStatus Status { get; set; } public DateTime UpdateTime { get; set; } public int AuthorId { get; set; } public Author Author { get; set; } public IEnumerable Comments { get; set; } } public class Comment : BaseModel { public int ArticleId { get; set; } public Article Article { get; set; } public string Content { get; set; } public DateTime CreateTime { get; set; } } public enum ArticleStatus { Abnormal, Normal } 3. CRUD å»ºç«‹æ•°æ®åº“è¿æ¥ã€‚ private static readonly string _connStr; private static IDbConnection Cnn => new MySqlConnection(_connStr); static DapperPlus() { _connStr = \"Server=127.0.0.1;Database=db_dapper;Uid=root;Pwd=xxxxxx;\"; } 3.1 éæŸ¥è¯¢æ“ä½œ 1) æ’å…¥æ•°æ® Dapperå¯ä»¥ä½¿ç”¨åŒæ ·çš„æ–¹å¼æ’å…¥ä¸€æ¡æˆ–å¤šæ¡æ•°æ®ã€‚ string sql = \"INSERT INTO author (NickName,RealName) VALUES(@nickName,@RealName)\"; var colin = new Author(\"Colin\", \"Colin Chang\"); var robin = new Author(\"Robin\", \"Robin Song\"); using (var cnn = Cnn) { await cnnExecuteAsync(sql, new Author[] { colin, robin }); } 2) æ›´æ–°æ•°æ® string sql = \"UPDATE author SET Address=@address WHERE Id=@id\"; using (var cnn = Cnn) { await cnnExecuteAsync(sql, new { id = 1, address = \"å±±ä¸œ\" }); } 3) åˆ é™¤æ•°æ® string sql = \"DELETE FROM author WHERE Id=@id\"; using (var cnn = Cnn) { await cnnExecuteAsync(sql,new {id=2}); } 3.2 æŸ¥è¯¢æ“ä½œ 1) ç®€å•æŸ¥è¯¢ var sql = \"SELECT * FROM author WHERE Id=@id\"; using (var cnn = Cnn) { var authors = await cnnQueryAsync(sql, new { id = 1 }); } å¸¸ç”¨çš„IN ()æ–¹å¼æŸ¥è¯¢ var sql = \"SELECT * FROM author WHERE Id IN @ids\"; using (var cnn = Cnn) { var authors = await cnnQueryAsync(sql, new { ids = new int[] { 1, 2 } }); } 2) å¤šè¡¨è¿æ¥æŸ¥è¯¢ æ­¤å¤„æ¼”ç¤ºä½¿ç”¨ä¸‰è¡¨è¿æ¥æŸ¥è¯¢ï¼ŒåŒæ—¶åŒ…å«1:1å’Œ1:Nçš„å…³ç³»ã€‚ var sql = @\"SELECT * FROM article AS ar JOIN author AS au ON ar.AuthorId = au.Id LEFT JOIN `comment` AS c ON ar.Id = c.ArticleId\"; var articles = new Dictionary(); using (var cnn = Cnn) { var data = await cnnQueryAsync(sql, (article, author, comment) => { //1:1 article.Author=author; //1:N if (!articles.TryGetValue(article.Id, out Article articleEntry)) { articleEntry = article; articleEntry.Comments = new List{}; articles.Add(article.Id, articleEntry); } articleEntry.Comments.Add(comment); return articleEntry; }); // var result= data.Distinct(); } var result = articles.Values; //data.Distinct()å’Œarticles.Valueséƒ½å¯ä»¥æ‹¿åˆ°æ•°æ®ï¼Œä¸”æ•°æ®å†…å®¹ç›¸åŒã€‚ 1:Nå…³ç³»çš„è¿æ¥æŸ¥ï¼ŒæŸ¥è¯¢å‡ºæ¥çš„æ•°æ®éƒ½æ˜¯è¿æ¥å±•å¼€ä¹‹åçš„å…¨éƒ¨æ•°æ®è®°å½•ï¼Œä»¥ä¸Šä»£ç ä¸­çš„Lambdaè¡¨è¾¾å¼ä¼šåœ¨éå†æ²¡æ¡æ•°æ®è®°å½•æ—¶æ‰§è¡Œä¸€æ¬¡ã€‚ 3) å¤šç»“æœé›†æŸ¥è¯¢ Dapperæ”¯æŒå¤šç»“æœé›†æŸ¥è¯¢ï¼Œå¯ä»¥æ‰§è¡Œä»»æ„å¤šæ¡æŸ¥è¯¢è¯­å¥ã€‚ // å¤šç»“æœé›†æŸ¥è¯¢ string sqls = @\" SELECT * FROM article WHERE Id=@id; SELECT * FROM `comment` WHERE ArticleId=@articleId;\"; using (var cnn = Cnn) { var reader = await cnnQueryMultipleAsync(sqls, new { id = 1, articleId = 1 }); var articles = await reader.ReadAsync(); var comments= await reader.ReadAsync(); var article = articles.FirstOrDefault(); if (article != null) article.Comments = comments; } å¤šç»“æœé›†æŸ¥è¯¢ä¸­ï¼Œé…åˆä½¿ç”¨å¤šæ¡å­˜åœ¨ä¸€å®šå…³è”å…³ç³»çš„æŸ¥è¯¢è¯­å¥ï¼Œå¯ä»¥åœ¨ä¸€å®šç¨‹ä¸Šå·§å¦™çš„å®ç°è¿æ¥æŸ¥è¯¢çš„æ•ˆæœï¼Œé¿å…å¤šè¡¨è¿æ¥æŸ¥è¯¢é”è¡¨çš„é—®é¢˜ã€‚ä»¥ä¸Šä»£ç å³å®ç°äº†æ­¤ç§æ•ˆæœã€‚ 3. äº‹åŠ¡å’Œå­˜å‚¨è¿‡ç¨‹ 3.1 äº‹åŠ¡ var scripts = new SqlScript[] { new SqlScript(\"UPDATE article SET UpdateTime=NOW() WHERE Id=@id\",new {id=2}), new SqlScript(\"UPDATE author SET BirthDate=NOW() WHERE Id=@id\",new {id=1}) } using (var cnn = Cnn) { IDbTransaction tran = null; try { cnnOpen(); tran = cnnBeginTransaction(); foreach (var script in scripts) await cnnExecuteAsync(script.Sql, script.Param, tran, commandType: script.CommandType); tran.Commit(); } catch { tran?.Rollback(); } } ä»¥ä¸Šæ¼”ç¤ºç”¨åˆ°çš„è„šæœ¬æ¨¡å‹ç±»å¦‚ä¸‹ï¼š public class SqlScript { public string Sql { get; set; } public object Param { get; set; } public CommandType CommandType { get; set; } public SqlScript(string sql, object param = null, CommandType cmdType = CommandType.Text) { Sql = sql; Param = param; CommandType = cmdType; } } 3.2 å­˜å‚¨è¿‡ç¨‹ Dapperå®Œå…¨æ”¯æŒå­˜å‚¨è¿‡ç¨‹ã€‚å­˜å‚¨è¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œä»£ç å°±ä¸å±•ç¤ºäº†ï¼Œè¯»è€…å¯ä»¥è‡ªå·±æŒ‰ç…§è‡ªå·±æƒ³æ³•éšæ„åˆ›å»ºã€‚ using (var cnn = Cnn) { var users = cnnQuery(\"spGetAuthors\", new {Id = 1}, commandType: CommandType.StoredProcedure); } ä½¿ç”¨ä¼ å…¥ä¼ å‡ºå‚æ•°çš„å­˜å‚¨è¿‡ç¨‹ã€‚ var p = new DynamicParameters(); p.Add(\"@a\", 11); p.Add(\"@b\", dbType: DbType.Int32, direction: ParameterDirection.Output); p.Add(\"@c\", dbType: DbType.Int32, direction: ParameterDirection.ReturnValue); using (var cnn = Cnn) { cnnExecute(\"spMagicProc\", p, commandType: CommandType.StoredProcedure); } int b = p.Get(\"@b\"); int c = p.Get(\"@c\"); 4. å…¶ä»– 4.1 å‚æ•°æ›¿æ¢ Dapperæ”¯æŒå¯¹SQLè¯­å¥ä¸­boolå’Œæ•°å­—ç±»å‹è¿›è¡Œæ›¿æ¢ã€‚ var sql = \"SELECT * FROM article WHERE Status= {=Normal}\"; using (var cnn = Cnn) { var articles = await cnnQueryAsync(sql, new {ArticleStatus.Normal}); } å‚æ•°æ›¿æ¢åœ¨ç‰¹å®šç±»å‹å­—æ®µä¸­éå¸¸å¥½ç”¨ï¼Œæ¯”å¦‚\"category id\", \"status code\" or \"region\" å‚æ•°æ›¿æ¢å¹¶éé‡‡ç”¨å‚æ•°è¯æŸ¥è¯¢ï¼Œè™½ç„¶ä½¿ç”¨æ–¹ä¾¿ä½†æ˜¯å»ºè®®ç»è¿‡æµ‹è¯•åè°¨æ…ä½¿ç”¨ã€‚ 4.2 ç¼“å­˜æŸ¥è¯¢ é»˜è®¤æƒ…å†µä¸‹Dapperä¼šå¯¹æ‰§è¡ŒSQLåçš„æ•´ä¸ªreaderè¿›è¡Œç¼“å­˜ï¼Œä»¥å‡å°‘æ•°æ®åº“é”å®šå’Œç½‘ç»œè¯·æ±‚æ—¶é—´ã€‚ç„¶è€Œæ‰§è¡Œå¤§æ‰¹é‡æŸ¥è¯¢æ“ä½œæ—¶ç¼“å­˜ä¼šå ç”¨å¤§é‡å†…å­˜ç©ºé—´ï¼Œæ­¤æ—¶æ‰§è¡ŒæŸ¥è¯¢æ“ä½œå¯ä»¥è®¾ç½®buffered: false ä»¥ç¦ç”¨ç¼“å­˜ã€‚ 4.3 ANSIç¼–ç  Dapperæ”¯æŒvarcharç±»å‹å‚æ•°,å¦‚æœæŸ¥è¯¢è¯­å¥éœ€è¦è¿‡æ»¤ä¸€ä¸ªvarcharç±»å‹çš„å­—æ®µå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æŒ‡å®šç¼–ç : Query(\"select * from Author where Address = @address\", new {address = new DbString { Value = \"å±±ä¸œ\", IsFixedLength = true, Length = 10, IsAnsi = true }); SQL Serverä¸­æŸ¥è¯¢unicode and ANSIå­—æ®µæ—¶åŠ¡å¿…ä½¿ç”¨unicodeç¼–ç  4.4 å¤šæ•°æ®ç±»å‹è¡Œ æŸäº›æƒ…å†µä¸‹åŒä¸€è¡Œæ•°æ®çš„æŸä¸ªå­—æ®µå¯ä»¥æ˜¯ä¸åŒçš„æ•°æ®ç±»å‹ã€‚è¿™ç§æƒ…å†µä½¿ç”¨IDataReader.GetRowParseréå¸¸æ–¹ä¾¿ã€‚ æœ‰shapesè¡¨ç»“æ„å¦‚ä¸Šå›¾ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®Typeå­—æ®µå°†æ¯è¡Œæ•°æ®æ˜ å°„ä¸ºCircle,Square,Triangleç­‰å…·ä½“ç±»å‹å¯¹è±¡ã€‚ä»¥ä¸‹ä¸ºç¤ºä¾‹ä»£ç ï¼š var shapes = new List(); using (var reader = connection.ExecuteReader(\"select * from Shapes\")) { // Generate a row parser for each type you expect. // The generic type is what the parser will return. // The argument (typeof(*)) is the concrete type to parse. var circleParser = reader.GetRowParser(typeof(Circle)); var squareParser = reader.GetRowParser(typeof(Square)); var triangleParser = reader.GetRowParser(typeof(Triangle)); var typeColumnIndex = reader.GetOrdinal(\"Type\"); while (reader.Read()) { IShape shape; var type = (ShapeType)reader.GetInt32(typeColumnIndex); switch (type) { case ShapeType.Circle: shape = circleParser(reader); break; case ShapeType.Square: shape = squareParser(reader); break; case ShapeType.Triangle: shape = triangleParser(reader); break; default: throw new NotImplementedException(); } shapes.Add(shape); } } 5. Dapper Plus Dapperä»…æä¾›äº†SqlHelperå¸¸ç”¨åŠŸèƒ½å’Œå¯¹è±¡æ˜ å°„ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå¯¹Dapperè¿›è¡ŒäºŒæ¬¡å°è£…æ‰©å±•ä»¥æ›´æ–¹ä¾¿çš„ä½¿ç”¨Dapperã€‚ Dapper Plusæ‰©å±•åœ¨æ— æŸDapperæ€§èƒ½çš„å‰æä¸‹ï¼ŒåŸºæœ¬è¦†ç›–äº†æ—¥å¸¸æ•°æ®æ“ä½œã€‚ Dapper PlusåŒ…å«äº†ä¸Šé¢çš„æ‰€æœ‰æ•°æ®æ“ä½œï¼Œæ¡ˆä¾‹ä¸­çš„ä»£ç å·²ç»åŒ…å«åœ¨å•å…ƒæµ‹è¯•é¡¹ç›®ä¸­ã€‚ æºç åœ°å€ï¼šhttps://github.com/colin-chang/dapper-plus Â© Colin Chang all right reservedï¼Œpowered by Gitbookæ–‡ä»¶ä¿®è®¢æ—¶é—´ï¼š 2018-12-10 20:13:55 "},"pages/https.html":{"url":"pages/https.html","title":"HTTPS","keywords":"","body":"å…¨é¢ HTTPS æ—¶ä»£ 1. HTTPS ç®€ä»‹ 2. HTTPS å·¥ä½œåŸç† 3. HTTPS ç°çŠ¶åˆ†æ 4. å…è´¹å‡çº§åˆ° HTTPS 5. GitHub Pages è‡ªå®šä¹‰åŸŸåæ”¯æŒ HTTPS 1. HTTPS ç®€ä»‹ 1) HTTP çš„é—®é¢˜ è®¤è¯ç½‘ç«™ å‡å¦‚ä½ æ­£åœ¨è®¿é—®æ”¯ä»˜å®ï¼Œæ€æ ·ç¡®å®šä½ æ­£åœ¨è®¿é—®çš„æ˜¯é˜¿é‡Œå·´å·´æä¾›çš„æ”¯ä»˜å®è€Œä¸æ˜¯å‡å†’ä¼ªåŠ£çš„é’“é±¼ç½‘ç«™å‘¢ï¼Ÿ æ•°æ®å®‰å…¨ HTTPåè®®ä»¥æ˜æ–‡æ–¹å¼å‘é€å†…å®¹ï¼Œä¸æä¾›ä»»ä½•æ–¹å¼çš„æ•°æ®åŠ å¯†ï¼Œå¦‚æœæ”»å‡»è€…æˆªå–äº†Webæµè§ˆå™¨å’Œç½‘ç«™æœåŠ¡å™¨ä¹‹é—´çš„ä¼ è¾“æŠ¥æ–‡ï¼Œå°±å¯ä»¥ç›´æ¥è¯»æ‡‚å…¶ä¸­çš„ä¿¡æ¯ï¼Œå› æ­¤ï¼ŒHTTPåè®®ä¸é€‚åˆä¼ è¾“ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚ï¼šä¿¡ç”¨å¡å·ã€å¯†ç ç­‰æ”¯ä»˜ä¿¡æ¯ã€‚ ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼ŒHTTPSå‡ºåœºäº† ğŸ‘ğŸ‘ğŸ‘ 2) HTTPS æ˜¯ä»€ä¹ˆ ä¼ è¾“å±‚å®‰å…¨æ€§ï¼ˆTLSï¼‰æ˜¯HTTPSçš„å®˜æ–¹åç§°ï¼Œä½ å¯èƒ½å¬è¯´è¿‡å®ƒç§°ä¸ºSSLï¼ˆå®‰å…¨å¥—æ¥å­—å±‚ï¼‰ï¼ŒSSLæ˜¯å·²å¼ƒç”¨çš„åç§°ï¼ŒTLSæ˜¯ä¸€ç§åŠ å¯†åè®®ï¼Œå¯é€šè¿‡è®¡ç®—æœºç½‘ç»œæä¾›å®‰å…¨é€šä¿¡ã€‚ HTTPSæ˜¯ä»¥å®‰å…¨ä¸ºç›®æ ‡çš„HTTPé€šé“ï¼Œç®€å•è®²æ˜¯HTTPçš„å®‰å…¨ç‰ˆï¼Œå³HTTPä¸‹åŠ å…¥SSLæˆ–TLSï¼ŒHTTPSçš„å®‰å…¨åŸºç¡€æ˜¯SSL/TLSã€‚ HTTPSåè®®çš„ä¸»è¦ä½œç”¨æœ‰ä¸¤ä¸ªï¼šä¸€ç§æ˜¯å»ºç«‹ä¸€ä¸ªä¿¡æ¯å®‰å…¨é€šé“ï¼Œæ¥ä¿è¯æ•°æ®ä¼ è¾“çš„å®‰å…¨ï¼›å¦ä¸€ç§å°±æ˜¯è®¤è¯ç½‘ç«™çš„çœŸå®æ€§ã€‚ 2. HTTPS å·¥ä½œåŸç† 1) ä¸»ä½“å¯¹è±¡ å®¢æˆ·ç«¯ã€‚é€šå¸¸æ˜¯æµè§ˆå™¨(Chromeã€IEã€FireFoxç­‰)ï¼Œä¹Ÿå¯ä»¥è‡ªå·±ç¼–å†™çš„å„ç§è¯­è¨€çš„å®¢æˆ·ç«¯ç¨‹åºã€‚ æœåŠ¡ç«¯ã€‚ä¸€èˆ¬æŒ‡æ”¯æŒHttpsçš„ç½‘ç«™ï¼Œæ¯”å¦‚githubã€æ”¯ä»˜å®ã€‚ CA(Certificate Authorities)æœºæ„ã€‚Httpsè¯ä¹¦ç­¾å‘å’Œç®¡ç†æœºæ„ï¼Œæ¯”å¦‚Symantecã€Comodoã€GoDaddyã€GlobalSignã€‚ 2) å·¥ä½œæµç¨‹ å®¢æˆ·ç«¯åœ¨ä½¿ç”¨HTTPSæ–¹å¼ä¸WebæœåŠ¡å™¨é€šä¿¡æ—¶æœ‰ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚ å·¥ä½œæµç¨‹ï¼ŒåŸºæœ¬åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µ: è®¤è¯æœåŠ¡å™¨ã€‚æµè§ˆå™¨å†…ç½®ä¸€ä¸ªå—ä¿¡ä»»çš„CAæœºæ„åˆ—è¡¨ï¼Œå¹¶ä¿å­˜äº†è¿™äº›CAæœºæ„çš„è¯ä¹¦ã€‚ç¬¬ä¸€é˜¶æ®µæœåŠ¡å™¨ä¼šæä¾›ç»CAæœºæ„è®¤è¯é¢å‘çš„æœåŠ¡å™¨è¯ä¹¦ï¼Œå¦‚æœè®¤è¯è¯¥æœåŠ¡å™¨è¯ä¹¦çš„CAæœºæ„ï¼Œå­˜åœ¨äºæµè§ˆå™¨çš„å—ä¿¡ä»»CAæœºæ„åˆ—è¡¨ä¸­ï¼Œå¹¶ä¸”æœåŠ¡å™¨è¯ä¹¦ä¸­çš„ä¿¡æ¯ä¸å½“å‰æ­£åœ¨è®¿é—®çš„ç½‘ç«™ï¼ˆåŸŸåç­‰ï¼‰ä¸€è‡´ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±è®¤ä¸ºæœåŠ¡ç«¯æ˜¯å¯ä¿¡çš„ï¼Œå¹¶ä»æœåŠ¡å™¨è¯ä¹¦ä¸­å–å¾—æœåŠ¡å™¨å…¬é’¥ï¼Œç”¨äºåç»­æµç¨‹ã€‚å¦åˆ™ï¼Œæµè§ˆå™¨å°†æç¤ºç”¨æˆ·ï¼Œæ ¹æ®ç”¨æˆ·çš„é€‰æ‹©ï¼Œå†³å®šæ˜¯å¦ç»§ç»­ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ç®¡ç†è¿™ä¸ªå—ä¿¡ä»»CAæœºæ„åˆ—è¡¨ï¼Œæ·»åŠ æˆ‘ä»¬æƒ³è¦ä¿¡ä»»çš„CAæœºæ„ï¼Œæˆ–è€…ç§»é™¤æˆ‘ä»¬ä¸ä¿¡ä»»çš„CAæœºæ„ã€‚ åå•†ä¼šè¯å¯†é’¥ã€‚å®¢æˆ·ç«¯åœ¨è®¤è¯å®ŒæœåŠ¡å™¨ï¼Œè·å¾—æœåŠ¡å™¨çš„å…¬é’¥ä¹‹åï¼Œåˆ©ç”¨è¯¥å…¬é’¥ä¸æœåŠ¡å™¨è¿›è¡ŒåŠ å¯†é€šä¿¡ï¼Œåå•†å‡ºä¸¤ä¸ªä¼šè¯å¯†é’¥ï¼Œåˆ†åˆ«æ˜¯ç”¨äºåŠ å¯†å®¢æˆ·ç«¯å¾€æœåŠ¡ç«¯å‘é€æ•°æ®çš„å®¢æˆ·ç«¯ä¼šè¯å¯†é’¥ï¼Œç”¨äºåŠ å¯†æœåŠ¡ç«¯å¾€å®¢æˆ·ç«¯å‘é€æ•°æ®çš„æœåŠ¡ç«¯ä¼šè¯å¯†é’¥ã€‚åœ¨å·²æœ‰æœåŠ¡å™¨å…¬é’¥ï¼Œå¯ä»¥åŠ å¯†é€šè®¯çš„å‰æä¸‹ï¼Œè¿˜è¦åå•†ä¸¤ä¸ªå¯¹ç§°å¯†é’¥çš„åŸå› ï¼Œæ˜¯å› ä¸ºéå¯¹ç§°åŠ å¯†ç›¸å¯¹å¤æ‚åº¦æ›´é«˜ï¼Œåœ¨æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨å¯¹ç§°åŠ å¯†ï¼Œå¯ä»¥èŠ‚çœè®¡ç®—èµ„æºã€‚å¦å¤–ï¼Œä¼šè¯å¯†é’¥æ˜¯éšæœºç”Ÿæˆï¼Œæ¯æ¬¡åå•†éƒ½ä¼šæœ‰ä¸ä¸€æ ·çš„ç»“æœï¼Œæ‰€ä»¥å®‰å…¨æ€§ä¹Ÿæ¯”è¾ƒé«˜ã€‚ åŠ å¯†é€šè®¯ã€‚æ­¤æ—¶å®¢æˆ·ç«¯æœåŠ¡å™¨åŒæ–¹éƒ½æœ‰äº†æœ¬æ¬¡é€šè®¯çš„ä¼šè¯å¯†é’¥ï¼Œä¹‹åä¼ è¾“çš„æ‰€æœ‰Httpæ•°æ®ï¼Œéƒ½é€šè¿‡ä¼šè¯å¯†é’¥åŠ å¯†ã€‚è¿™æ ·ç½‘è·¯ä¸Šçš„å…¶å®ƒç”¨æˆ·ï¼Œå°†å¾ˆéš¾çªƒå–å’Œç¯¡æ”¹å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´ä¼ è¾“çš„æ•°æ®ï¼Œä»è€Œä¿è¯äº†æ•°æ®çš„ç§å¯†æ€§å’Œå®Œæ•´æ€§ã€‚ Httpså°±æ˜¯Httpè·‘åœ¨SSLæˆ–è€…TLSä¸Šï¼Œæ‰€ä»¥æœ¬æ–‡è®¨è®ºçš„åŸç†å’Œæµç¨‹å…¶å®æ˜¯SSLå’ŒTLSçš„æµç¨‹ï¼Œå¯¹äºå…¶å®ƒä½¿ç”¨SSLæˆ–è€…TLSçš„åº”ç”¨å±‚åè®®ï¼Œæœ¬æ–‡å†…å®¹ä¸€æ ·æœ‰æ•ˆã€‚ 3. HTTPS ç°çŠ¶åˆ†æ 1) ä¼˜ç¼ºç‚¹åˆ†æ ææ˜ç™½äº†Httpsçš„å·¥ä½œåŸç†åï¼Œå…¶ä¼˜ç¼ºç‚¹å°±å¾ˆå®¹æ˜“ç†è§£äº†ã€‚ ä¼˜ç‚¹ å°½ç®¡HTTPSå¹¶éç»å¯¹å®‰å…¨ï¼ŒæŒæ¡æ ¹è¯ä¹¦çš„æœºæ„ã€æŒæ¡åŠ å¯†ç®—æ³•çš„ç»„ç»‡åŒæ ·å¯ä»¥è¿›è¡Œä¸­é—´äººå½¢å¼çš„æ”»å‡»ï¼Œä½†HTTPSä»æ˜¯ç°è¡Œæ¶æ„ä¸‹æœ€å®‰å…¨çš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”è§£å†³äº†ç½‘ç«™è®¤è¯çš„é—®é¢˜ï¼Œè¿™ä¸¤ç‚¹ä¹Ÿæ­£æ˜¯æˆ‘ä»¬åœ¨æœ€å¼€å§‹æå‡ºçš„é—®é¢˜ã€‚å¦å¤–ï¼ŒGoogleæ›¾è¡¨ç¤ºâ€œæ¯”èµ·åŒç­‰HTTPç½‘ç«™ï¼Œé‡‡ç”¨HTTPSåŠ å¯†çš„ç½‘ç«™åœ¨æœç´¢ç»“æœä¸­çš„æ’åå°†ä¼šæ›´é«˜â€ï¼Œå› æ­¤é‡‡ç”¨HTTPSçš„ç½‘ç«™æ›´æœ‰åˆ©äºSEO. ç¼ºç‚¹ HTTPSåè®®æ¡æ‰‹é˜¶æ®µæ¯”è¾ƒè´¹æ—¶ï¼Œæ²¡æœ‰HTTPé«˜æ•ˆï¼Œä¸”ä¼šä½¿é¡µé¢çš„åŠ è½½æ—¶é—´å»¶é•¿è¿‘åŠŸè€—å¢åŠ ï¼› SSLè¯ä¹¦æ”¶è´¹ SSLè¯ä¹¦é€šå¸¸éœ€è¦ç»‘å®šIPï¼Œä¸èƒ½åœ¨åŒä¸€IPä¸Šç»‘å®šå¤šä¸ªåŸŸåã€‚ 2) ç°çŠ¶åˆ†æ äº†è§£äº†HTTPSçš„ä¼˜ç¼ºç‚¹ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹å…¶å‘å±•ç°çŠ¶ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œå¾ˆå¤šå…¬å¸éƒ½ä¼šç›´æ¥è´­ä¹°ç”±GlobalSignã€GeoTrustã€Verisignç­‰å…¨çƒå…¬è®¤çš„æ•°å­—è¯ä¹¦é¢å‘æœºæ„é¢å‘çš„SSLè¯ä¹¦ã€‚è´­ä¹°ï¼Ÿæ²¡é”™ï¼Œå¤§å¤šæ•°SSLè¯ä¹¦éƒ½éœ€è¦æŒ‰å¹´ä»˜è´¹ä½¿ç”¨ï¼Œè€Œä¸”ä»·æ ¼ä¸è²ã€‚è¿‡å»HTTPSè¢«è®¤ä¸ºæ¯”è¾ƒä½æ•ˆã€‚è¿™ä¹Ÿæ˜¯å‰é¢æåˆ°çš„HTTPSçš„ä¸»è¦ç¼ºç‚¹ã€‚ ä½†éšç€æŠ€æœ¯çš„å‘å±•ï¼Œç°åœ¨æœºå™¨å˜å¾—æ›´å¿«ï¼Œå·²ç»è§£å†³äº†æ€§èƒ½é—®é¢˜ï¼ŒLet's Encryptç­‰æœºæ„æä¾›å…è´¹TLSè¯ä¹¦ï¼Œè¿™ä¸¤é¡¹å‘å±•æ”¹å˜äº†æ¸¸æˆï¼Œå¹¶ä½¿TLSæˆä¸ºä¸»æµã€‚ 3) å…è´¹è¯ä¹¦ Let's Encrypt æ˜¯ä¸€ä¸ªå…è´¹ã€å¼€æ”¾ï¼Œè‡ªåŠ¨åŒ–çš„è¯ä¹¦é¢å‘æœºæ„ï¼Œç”± ISRGï¼ˆInternet Security Research Groupï¼‰è¿ä½œã€‚ISRG æ˜¯ä¸€ä¸ªå…³æ³¨ç½‘ç»œå®‰å…¨çš„å…¬ç›Šç»„ç»‡ï¼Œå…¶èµåŠ©å•†åŒ…æ‹¬ Mozillaã€Akamaiã€Ciscoã€EFFã€Chromeã€IdenTrustã€Facebookç­‰å…¬å¸ã€‚ISRG çš„ç›®çš„æ˜¯æ¶ˆé™¤èµ„é‡‘å’ŒæŠ€æœ¯é¢†åŸŸçš„éšœç¢ï¼Œå…¨é¢æ¨è¿›ç½‘ç«™ä»HTTPåˆ°HTTPSè¿‡åº¦çš„è¿›ç¨‹ã€‚ ç›®å‰ï¼ŒåŒ…æ‹¬FireFoxã€Chromeåœ¨å†…çš„ä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒLet's Encryptè¯ä¹¦ï¼Œå·²ç»æœ‰ä¸å°‘ç”¨æˆ·åœ¨çœŸå®é¡¹ç›®ä¸­ä½¿ç”¨Let's Encryptè¯ä¹¦ã€‚Let's Encryptå…è´¹SSLè¯ä¹¦çš„æœ‰æ•ˆæœŸæ˜¯90å¤©ï¼Œåˆ°æœŸåå¯ä»¥å†ç»­æœŸï¼Œè¿™æ ·ä¹Ÿå°±å¯ä»¥å˜ç›¸é•¿æœŸä½¿ç”¨äº†ã€‚ 4. å…è´¹å‡çº§åˆ° HTTPS ä¸€èˆ¬çš„HTTPSä½¿ç”¨æµç¨‹å¦‚ä¸‹ã€‚ Letâ€™s Encrypt TLS å…è´¹è¯ä¹¦ä½¿ç”¨ Letâ€™s Encrypt TLSè¯ä¹¦å¯ä»¥è‡ªåŠ¨åŒ–ç”Ÿæˆå’Œæ›´æ–°ï¼Œç”±äºä»–ä»¬æ˜¯å…è´¹çš„ï¼Œæ‰€ä»¥æ²¡æœ‰ç†ç”±ä¸å»åšã€‚ç›¸ä¿¡å¤§å®¶ä¹Ÿæ›´å…³æ³¨å…è´¹è¯ä¹¦å¦‚ä½•ä½¿ç”¨ï¼Œä¸å¤šè¯´ï¼Œè¿™å°±æèµ·æ¥ ğŸ˜ŠğŸ˜ŠğŸ˜Š ä»¥ä¸‹æ¡ˆä¾‹ä½¿ç”¨ Ubuntu 18.10/nginx 1.15.5 ç¯å¢ƒã€‚ æ ¹æ®Letâ€™s Encrypt å®˜ç½‘æ¨èï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ Certbot ACME client é€‰æ‹©å¯¹åº”çš„è½¯ä»¶å’Œæ“ä½œç³»ç»Ÿç¯å¢ƒ å‚ç…§ç½‘ç«™ç»™å‡ºçš„å‘½ä»¤è¿›è¡Œå®‰è£…/é…ç½®/æ›´æ–° è¯ä¹¦ å®Œæˆä»¥ä¸Šé…ç½®åï¼Œè®¿é—®ä½ çš„ç½‘ç«™ï¼Œä¸å‡ºæ„å¤–å·²ç»å‡çº§åˆ°httpsäº†ğŸ‘ è‡ªåŠ¨é…ç½®å®Œæˆä¹‹åçš„Nginxçš„é…ç½®æ–‡ä»¶å½¢å¦‚ï¼š server { server_name localhost 104.199.230.207 bet518.win www.bet518.win; location / { proxy_pass localhost:5000; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection keep-alive; proxy_set_header Host $host; proxy_cache_bypass $http_upgrade; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; } listen 443 ssl; # managed by Certbot ssl_certificate /etc/letsencrypt/live/bet518.win/fullchain.pem; # managed by Certbot ssl_certificate_key /etc/letsencrypt/live/bet518.win/privkey.pem; # managed by Certbot include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot } server { if ($host = www.bet518.win) { return 301 https://$host$request_uri; } # managed by Certbot if ($host = bet518.win) { return 301 https://$host$request_uri; } # managed by Certbot listen 80; server_name localhost 104.199.230.207 bet518.win www.bet518.win; return 404; # managed by Certbot } 5. GitHub Pages è‡ªå®šä¹‰åŸŸåæ”¯æŒ HTTPS 2018å¹´5æœˆ1æ—¥ï¼ŒGitHub Pages å®˜æ–¹å®£å¸ƒ GitHub Pages å¯¹è‡ªå®šä¹‰åŸŸåæ”¯æŒ HTTPSã€‚ https://blog.github.com/2018-05-01-github-pages-custom-domains-https/ ä»€ä¹ˆï¼Œä½ é—®æˆ‘ä¸ºä»€ä¹ˆè¦GitHub Pageä½¿ç”¨HTTPSï¼Ÿç®€å•æ¥è¯´ï¼Œé™¤äº† HTTPS è‡ªèº«å¸¦æ¥çš„åŠ å¯†ã€é˜²åŠ«æŒç­‰ç‰¹æ€§å¤–ï¼ŒGithub å®˜æ–¹åŸºäº HTTPS é…åˆ CNDï¼Œä½¿å¾—ç½‘ç«™çš„åŠ è½½é€Ÿåº¦æ›´å¿«ï¼Œè¿˜èƒ½æä¾›é¢å¤–çš„é˜²å¾¡ DDoS æ”»å‡»çš„ä¿æŠ¤ã€‚ GitHubå®˜æ–¹æ–‡æ¡£å·²ç»è¯´æ˜äº†å¦‚ä½•å¼€å¯HTTPSã€‚è‹±æ–‡ä¸ç†Ÿæ‚‰çš„å°ä¼™ä¼´çœ‹æˆ‘ä¸‹é¢çš„ç®€å•ç²—æš´çš„è®²è§£å³å¯ã€‚ 1ï¼‰ç»‘å®šåŸŸå æ³¨å†ŒåŸŸåä¸å¤šè¯´ã€‚å¦‚ä½•ä½¿ç”¨GitHub Pagesä¸­åˆ›å»ºåšå®¢ä¹Ÿä¸å¤šè¯´ã€‚åºŸè¯å®Œäº†ï¼Œä¸‹é¢å¼€å§‹æ­£é¢˜ï¼Œä»¥åšä¸»è‡ªå·±çš„è´¦æˆ·ä¸ºä¾‹(GitHubç”¨æˆ·åä¸ºcolin-chang) è§£æåŸŸå Github Pages é¡¹ç›®é…ç½® æ‰“å¼€ username.github.io é¡¹ç›®è®¾ç½®,å¹¶æ‰¾åˆ° GitHub Pages æ¨¡å—çš„Custom domainå¡«å†™è‡ªå·±çš„åŸŸåå¹¶ç‚¹å‡» Save åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»ºä¸€ä¸ªåä¸º â€œCNAMEâ€ çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸ºè‡ªå·±çš„åŸŸå 2ï¼‰å¼€å¯HTTPS æ‰¾åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„Enforce HTTPSé€‰é¡¹å¹¶å‹¾é€‰ã€‚ç„¶åè®¿é—®ä¸‹è‡ªå·±çš„åŸŸåï¼Œä¸å‡ºæ„å¤–çš„è¯ï¼Œå·²ç»æ˜¯httpsäº†ã€‚ é‚£ä¹ˆå¦‚æœå¦‚æœä¹‹å‰å·²ç»å¼€å¯äº†è‡ªå®šä¹‰åŸŸåï¼Œ enforce HTTPS æ— æ³•å‹¾é€‰ä¸”æ€ä¹ˆåŠï¼Ÿå¾€ä¸‹çœ‹... æŠŠ Custom domain ä¸­çš„å€¼æ¸…ç©ºï¼Œå¹¶ç‚¹å‡» Save è¿›è¡Œä¿å­˜ï¼› åœ¨ Custom domain ä¸­çš„å¡«å…¥ä¹‹å‰æ¸…ç©ºçš„å€¼ï¼Œå¡«å…¥åç‚¹å‡»ä¿å­˜ï¼› åˆ·æ–°é¡¹ç›®è®¾ç½®é¡µï¼Œå¦‚æœ enforce HTTPS å¯å‹¾é€‰ï¼Œå‹¾é€‰å³å¯ï¼› å¦‚æœ enforce HTTPS ä¸å¯å‹¾é€‰ï¼Œå¹¶ä¸”æç¤º Not yet available for your site because the certificate has not finished being issuedâ€ ï¼Œè¯´æ˜è¯ä¹¦å°šæœªç”³è¯·å®Œæˆï¼Œç­‰å¾…ä¸€å¤©å³å¯ã€‚ å®Œæˆä»¥ä¸Šæ­¥éª¤é‡æ–°è®¿é—®è‡ªå·±çš„åŸŸåï¼Œäº«å—httpså§å¼€å§‹ æ³¨æ„ï¼Œå¦‚æœä½¿ç”¨ä»ç„¶å­˜åœ¨é—®é¢˜ï¼Œè¯·æ£€æŸ¥è‡ªå·±çš„ç½‘ç«™å¼•ç”¨çš„èµ„æºæ–‡ä»¶æœ‰æ²¡æœ‰ä½¿ç”¨äº† http åè®®ï¼Œè¯·æ›¿æ¢æˆç›¸åº”çš„ https èµ„æºã€‚ Â© Colin Chang all right reservedï¼Œpowered by Gitbookæ–‡ä»¶ä¿®è®¢æ—¶é—´ï¼š 2018-12-12 00:45:21 "}}